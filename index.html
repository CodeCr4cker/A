<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Coderstar</title>
  <style>
    * { box-sizing: border-box; }

    .page-content {
      opacity: 0;
      transform: translateY(-20px);
      transition: opacity 0.8s ease, transform 0.8s ease;
      position: relative;
      z-index: 3; /* Ensure content is above collage/video */
      padding: 2em; /* Add padding to prevent content from touching edges */
      display: flex;
      flex-direction: column;
      justify-content: center; /* Center content vertically if any */
      align-items: center; /* Center content horizontally if any */
      height: 100%; /* Take full height of the page */
      width: 100%; /* Take full width of the page */
    }
    .page-content.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    body {
      margin: 0;
      display: flex;
      min-height: 100dvh;
      perspective: 1000px;
      font-size: 1rem;
      overflow: hidden;
      color: hsl(180 68% 5%);
      background-image: radial-gradient(circle farthest-corner at 50% 50%, hsl(189, 56%, 73%) 30%, hsl(150, 80%, 75%) 100%);
    }

    .book {
      position: relative;
      display: flex;
      margin: auto;
      width: 40cqmin;
      height: 550px;
      pointer-events: auto;
      transform-style: preserve-3d;
      transition: translate 1s;
      translate: calc(min(var(--c), 1) * 50%) 0%;
      rotate: 1 0 0 30deg;
      counter-reset: page -1;
    }

    .neon-typing {
      color: var(--neon-yellow);
      text-shadow: var(--neon-shadow-yellow);
    }

    .page {
      --thickness: 4;
      flex: none;
      display: flex;
      width: 100%;
      font-size: 1.5cqmin;
      pointer-events: all;
      user-select: none;
      transform-style: preserve-3d;
      transform-origin: left center;
      transition:
        transform 1s,
        rotate 1s ease-in calc((min(var(--i), var(--c)) - max(var(--i), var(--c))) * 50ms);
      translate: calc(var(--i) * -100%) 0px 0px;
      transform: translateZ( calc((var(--c) - var(--i) - 0.5) * calc(var(--thickness) * .23cqmin)));
      rotate: 0 1 0 calc(clamp(0, var(--c) - var(--i), 1) * -180deg);
      box-shadow: 0em .5em 1em -.2em #00000020;
      cursor: pointer; /* Indicate clickable pages */
    }

    .front,
    .back {
      position: relative;
      flex: none;
      width: 100%;
      backface-visibility: hidden;
      overflow: hidden;
      background-color: #fff;
      display: flex;
      flex-flow: column wrap;
      justify-content: space-between;
      border: 1px solid #0002;
    }

    /* Collage Container Styles */
    .collage-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: grid;
      grid-template-columns: repeat(2, 1fr); /* 2 columns */
      grid-template-rows: repeat(2, 1fr);    /* 2 rows */
      gap: 5px; /* Space between images */
      padding: 10px; /* Padding around the collage */
      z-index: 1; /* Ensure collage is behind content */
      overflow: hidden; /* Hide overflow if images are slightly larger */
    }

    .collage-container img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* Cover the area without distortion */
      opacity: 0.8; /* Slightly transparent to allow background color to show through */
      transition: transform 0.3s ease; /* Smooth hover effect */
    }

    .collage-container img:hover {
      transform: scale(1.05); /* Slight zoom on hover */
    }

    /* Video Container Styles */
    .video-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1; /* Ensure video is behind content */
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #000; /* Black background for video */
    }

    .video-container video {
      width: 100%;
      height: 100%;
      object-fit: cover; /* Cover the area, cropping if necessary */
    }

    .front::after,
    .back::after {
      position: absolute;
      bottom: 1em;
      counter-increment: page;
      content: counter(page) ".";
      font-size: 0.8em;
      z-index: 4; /* Ensure page number is above content and media */
    }

    .front::after { right: 1em; }
    .back {
      translate: -100% 0;
      rotate: 0 1 0 180deg;
    }
    .back::after { left: 1em; }

    .cover {
      background: radial-gradient(circle farthest-corner at 80% 20%, hsl(150 80% 20% / .3) 0%, hsl(170 60% 10% / .1) 100%),
      hsl(231, 32%, 29%) url("https://raw.githubusercontent.com/CodeCr4cker/book-flip/main/img/front.jpg") 50% / cover;
      color: hsl(200 30% 98%);
      pointer-events: auto;
    }

    .cover::after { content: ""; } /* No page number on cover */

    h1 {
      font-size: 1.8em;
      margin: 0.5em 0;
    }

    h2 {
      font-size: 1.3em;
      margin: 0.4em 0;
    }

    p {
      font-size: 0.95em;
      margin: 0.4em 0;
    }

    @media (max-width: 768px) {
      body {
        font-size: 0.9rem;
      }

      .page {
        font-size: 1.2cqmin;
      }

      h1 {
        font-size: 1.5em;
      }

      h2 {
        font-size: 1.1em;
      }

      p {
        font-size: 0.85em;
      }
      .book {
        height: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="book">
    <!-- Cover Page -->
    <div class="page">
      <div class="front cover">
        <!-- No images on front cover -->
      </div>
      <div class="back">
        <!-- No images on back of cover -->
      </div>
    </div>

    <!-- Content Page 1 (Collage) -->
    <div class="page">
      <div class="front">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+1.1" alt="Collage Image 1.1">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+1.2" alt="Collage Image 1.2">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+1.3" alt="Collage Image 1.3">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+1.4" alt="Collage Image 1.4">
        </div>
        <div class="page-content"><h2><span id="type1" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+1.5" alt="Collage Image 1.5">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+1.6" alt="Collage Image 1.6">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+1.7" alt="Collage Image 1.7">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+1.8" alt="Collage Image 1.8">
        </div>
        <div class="page-content"><h2><span id="type2" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 2 (Collage) -->
    <div class="page">
      <div class="front">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+2.1" alt="Collage Image 2.1">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+2.2" alt="Collage Image 2.2">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+2.3" alt="Collage Image 2.3">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+2.4" alt="Collage Image 2.4">
        </div>
        <div class="page-content"><h2><span id="type3" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+2.5" alt="Collage Image 2.5">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+2.6" alt="Collage Image 2.6">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+2.7" alt="Collage Image 2.7">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+2.8" alt="Collage Image 2.8">
        </div>
        <div class="page-content"><h2><span id="type4" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 3 (Collage) -->
    <div class="page">
      <div class="front">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+3.1" alt="Collage Image 3.1">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+3.2" alt="Collage Image 3.2">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+3.3" alt="Collage Image 3.3">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+3.4" alt="Collage Image 3.4">
        </div>
        <div class="page-content"><h2><span id="type5" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+3.5" alt="Collage Image 3.5">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+3.6" alt="Collage Image 3.6">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+3.7" alt="Collage Image 3.7">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+3.8" alt="Collage Image 3.8">
        </div>
        <div class="page-content"><h2><span id="type6" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 4 (Collage) -->
    <div class="page">
      <div class="front">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+4.1" alt="Collage Image 4.1">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+4.2" alt="Collage Image 4.2">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+4.3" alt="Collage Image 4.3">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+4.4" alt="Collage Image 4.4">
        </div>
        <div class="page-content"><h2><span id="type7" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="collage-container">
          <img src="https://via.placeholder.com/250x350/FFD700/FFFFFF?text=Collage+4.5" alt="Collage Image 4.5">
          <img src="https://via.placeholder.com/250x350/FFA07A/FFFFFF?text=Collage+4.6" alt="Collage Image 4.6">
          <img src="https://via.placeholder.com/250x350/98FB98/FFFFFF?text=Collage+4.7" alt="Collage Image 4.7">
          <img src="https://via.placeholder.com/250x350/ADD8E6/FFFFFF?text=Collage+4.8" alt="Collage Image 4.8">
        </div>
        <div class="page-content"><h2><span id="type8" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 5 (Video) -->
    <div class="page">
      <div class="front">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type9" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type10" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 6 (Video) -->
    <div class="page">
      <div class="front">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type11" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type12" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 7 (Video) -->
    <div class="page">
      <div class="front">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type13" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type14" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 8 (Video) -->
    <div class="page">
      <div class="front">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type15" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type16" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Content Page 9 (Video) -->
    <div class="page">
      <div class="front">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type17" class="neon-typing"></span></h2></div>
      </div>
      <div class="back">
        <div class="video-container">
          <video controls loop muted autoplay>
            <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="page-content"><h2><span id="type18" class="neon-typing"></span></h2></div>
      </div>
    </div>

    <!-- Back Cover Page -->
    <div class="page">
      <div class="front">
        <!-- No images on front of back cover -->
      </div>
      <div class="back cover">
        <!-- No images on back cover -->
      </div>
    </div>
  </div>

  <script>
    let globalClicked = false;
    let currentPageIndex = 0; // Track the currently visible page pair (0-indexed)
    const totalContentPages = 9; // Number of pages with actual content (4 collage + 5 video)

    document.addEventListener("DOMContentLoaded", () => {
      const elBook = document.querySelector(".book");
      flipBook(elBook);
    });

    function flipBook(elBook) {
      elBook.style.setProperty("--c", 0);
      const pages = elBook.querySelectorAll(".page");
      pages.forEach((page, idx) => page.style.setProperty("--i", idx));

      // Add click listener to the cover page to start the book
      const coverPage = pages[0];
      coverPage.addEventListener("click", () => {
        if (globalClicked) return;
        globalClicked = true;
        elBook.style.setProperty("--c", 1); // Open to the first content page
        currentPageIndex = 0;
        // No typing sequence on initial open as there's no text
      });

      // Add click listeners to all content pages for manual flipping
      for (let i = 1; i < pages.length; i++) { // Loop through all pages including the last cover page for flipping
        const pageElement = pages[i];
        pageElement.addEventListener("click", () => {
          if (!globalClicked) return; // Only allow flipping after the cover is opened

          // If it's the last page (back cover), reset the book
          if (i === pages.length - 1) {
            closeAndResetBook(elBook);
          } else if (currentPageIndex === i - 1) { // Ensure user clicks on the currently active page pair
            flipToNextPage(elBook);
          }
        });
      }

      window.resetBook = () => {
        globalClicked = false;
        currentPageIndex = 0;
        elBook.style.setProperty("--c", 0);
        document.querySelectorAll('.neon-typing').forEach(el => el.innerHTML = '');
        document.querySelectorAll('.page-content').forEach(content => content.classList.remove('animate-in'));
        console.log("Book reset completed");
      };
    }

    const typingPages = [
      { front: "#type1", back: "#type2", frontText: ``, backText: `` },
      { front: "#type3", back: "#type4", frontText: ``, backText: `` },
      { front: "#type5", back: "#type6", frontText: ``, backText: `` },
      { front: "#type7", back: "#type8", frontText: ``, backText: `` },
      // New pages (5 video pages) with empty text
      { front: "#type9", back: "#type10", frontText: ``, backText: `` },
      { front: "#type11", back: "#type12", frontText: ``, backText: `` },
      { front: "#type13", back: "#type14", frontText: ``, backText: `` },
      { front: "#type15", back: "#type16", frontText: ``, backText: `` },
      { front: "#type17", back: "#type18", frontText: ``, backText: `` }
    ];

    function typeText(el, text, callback) {
      let i = 0;
      el.innerHTML = "";
      function typeChar() {
        if (i < text.length) {
          el.innerHTML += text[i++];
          setTimeout(typeChar, 30);
        } else {
          callback && callback();
        }
      }
      // Only type if there's actual text
      if (text.length > 0) {
        typeChar();
      } else {
        callback && callback(); // Call callback immediately if no text
      }
    }

    function startTypingSequence(elBook, pageIdx) {
      if (pageIdx >= typingPages.length) return;

      const { front, back, frontText, backText } = typingPages[pageIdx];
      const frontEl = document.querySelector(front);
      const backEl = document.querySelector(back);
      const frontContent = frontEl.closest('.front').querySelector('.page-content');
      const backContent = backEl.closest('.back').querySelector('.page-content');

      // Animate in content area even if no text
      frontContent.classList.add('animate-in');
      typeText(frontEl, frontText, () => {
        backContent.classList.add('animate-in');
        typeText(backEl, backText, () => {
          // Typing for the current page pair is complete.
        });
      });
    }

    function flipToNextPage(elBook) {
      if (currentPageIndex < totalContentPages - 1) {
        currentPageIndex++;
        elBook.style.setProperty("--c", currentPageIndex + 1); // Flip to the next page pair
        // No typing sequence as there's no text
      } else {
        // Reached the last content page, now flip to the back cover.
        // The reset will happen when the back cover itself is clicked.
        elBook.style.setProperty("--c", totalContentPages + 1); // Flip to the back cover
      }
    }

    function closeAndResetBook(elBook) {
      let currentC = parseInt(elBook.style.getPropertyValue("--c")) || (totalContentPages + 1);
      function closePage() {
        if (currentC > 0) {
          currentC--;
          elBook.style.setProperty("--c", currentC);
          setTimeout(closePage, 400);
        } else {
          setTimeout(() => {
            window.resetBook();
          }, 500);
        }
      }
      closePage();
    }
  </script>
</body>
</html>
